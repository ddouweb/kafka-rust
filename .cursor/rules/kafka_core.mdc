---
description: 
globs: 
alwaysApply: false
---
---
description: Kafka核心特性规范
globs: ["**/*.rs"]
alwaysApply: true
---

# Kafka核心特性规范

## 消息存储
- 使用追加写入（Append-only）日志
- 支持消息压缩
- 实现日志分段（Log Segments）
- 支持日志清理策略

## 索引管理
- 实现消息偏移量索引
- 实现时间戳索引
- 支持稀疏索引
- 索引文件定期合并

## 数据持久化
- 使用内存映射文件（mmap）
- 实现页缓存机制
- 支持异步刷盘
- 保证数据一致性

## 消息处理
- 支持消息批量发送
- 实现消息确认机制
- 支持消费者组
- 实现偏移量管理

## 集群特性
- 实现节点发现
- 支持节点健康检查
- 实现副本同步
- 支持Leader选举

## 性能优化
- 使用异步IO
- 实现连接池
- 使用顺序IO
- 实现批量写入 